
# A PCHome/Momo Baby Utilities Price Comparing Website

This is a website that compares baby utility products available on two main e-commerce websites in Taiwan, PChome and Momo. The baby utilities are classified based on the baby's age in months, so parents with newborns can easily determine what to prepare for different stages of baby growth.


## Demo

##### Before login with Line:
![Before Login](https://d1pp7d431dp3ag.cloudfront.net/BeforeLogin.gif)

##### After login with Line:
![After Login](https://d1pp7d431dp3ag.cloudfront.net/AfterLogin.gif)


## Features

- Products classified based on baby month ages.
- Current Price comparison between PChome and Momo.
- Product filter based on brand name.
- Check history price of a product.
- Track products.(member exclusive)
- Price notification.(member exclusive)
- Member login through Line login.

## Tech Stack

- **Client:** HTML, CSS, JavaScript, Chart.js

- **Server:** Python, Flask, Docker, AWS EC2, AWS RDS MySQL, Nginx, AWS lambda, AWS SQS, AWS EventBridge

![Back-end architecture](/SomeImgs/BackEndArchitect.png)

## Database structure
![Database structure](/SomeImgs/PricePick_DB_fig.png)
- ProductIDs in `MomoProducts` and in `PCHomeProducts` are using index to increase query efficiency.
- Tables are in 3NF.
- Tables that are related to products are referenced to each other through the ProductID using forign keys.

## Product matching between PCHome, Momo
#### The matching process involves 3 steps:
1. Word split:
    - Create keywords
2. MySQL fulltext search
    - Narrow down data range
3. Find max matching point and matching rate > 0.6
    - Max matching point:
      - Number of intersection words
    - Matching rate > 0.6
      - Number of intersection words/number of union words
    - Best fit

#### An example
![step 1](/SomeImgs/ProductMatching1.png)
![step 2](/SomeImgs/ProductMatching2.png)
![step 3](/SomeImgs/ProductMatching3.png)

## API Reference

#### Get products

```http
  GET /api/compare
```

| Parameter | Type     | Description                |
| :-------- | :------- | :------------------------- |
| `Category` | `string` | **Required**. The category of the product shown in home page. |
| `Page` | `Integer` | The page information. 10 products/page.|
| `Brand` | `Integer` | Specified when only want to get products of a specific brand. |
| `token` | `String` | The user JWT token, used to get check if the user tracked any product under the specific category and display the followed icon on the product page. |

#### Get product brands under a specific category

```http
  GET /api/brand
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `Category`      | `string` | **Required**. The category of the product shown in home page. |

#### Get history price
```http
  GET /api/history
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `momoID`      | `string` | **Required**. The product ID of momo. |
| `PCHomeID`      | `string` | **Required**. The product ID of PCHome. |

#### Track a product
```http
  GET /api/trackProduct
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | The user JWT token, used to get check if the user tracked any product under the specific category and display the followed icon on the product page. |
| `momoID`      | `string` | **Required**. The product ID of momo. |
| `PCHomeID`      | `string` | **Required**. The product ID of PCHome. |

#### Delete a tracked product
```http
  DELETE /api/trackProduct
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token`      | `string` | **Required**. The user JWT token, used to get check if the user tracked any product under the specific category. |
| `momoID`      | `string` | **Required**. The product ID of momo. |
| `PCHomeID`      | `string` | **Required**. The product ID of PCHome. |

#### Display all the tracking product of a member
```http
  GET /api/trackingRecord
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | The user JWT token |

### Start line login
```http
  GET /api/login
```
Redirect user to official line login authentication website.

#### Receive the authorization code from line login
```http
  GET /api/callback
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `code`      | `string` | **Required**. Authorization code used to get an access token. |
| `state`      | `string` | **Required**. A unique alphanumeric string used to prevent cross-site request forgery, generated by `/api/login`.  |
| `error_desc`      | `string` | A description of the error if something went wrong during requesting authorization code. |
| `error_code`      | `string` | Error code. |

#### Check if a member logs in
```http
  GET /api/auth
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | The user JWT token |

#### logs user out
```http
  DELETE /api/auth
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | The user JWT token |

#### Retrieve member information
```http
  GET /api/member
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | **Required**. The user JWT token |
| `page` | `String` | If the member tracks product, get the tracking produt information. 10 products/page. |

#### Send message to user through ling message API
```http
  GET /api/Notify
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | **Required**. The user JWT token |
| `TrackingID` | `Integer` | **Required**.The tracking ID of the tracked product by the member. |
| `TargetPrice` | `Integer` | **Required**.The target price will trigger a notification to member when the product price is reached. |
| `ProductTitle` | `String` | **Required**.Used to send the message to the member about the enabling of the price alert function for the product with the product title. |

#### Disable price alert notification
```http
  DELETE /api/Notify
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `token` | `String` | **Required**. The user JWT token |
| `TrackingID` | `Integer` | **Required**.The tracking ID of the tracked product by the member. |

